# brightbinder.lua
Внутриигровые диалоговые меню с AHK-подобными привязками для GTA SA:MP (MoonLoader).  
Поддерживается подстановка информации о выбранном игроке.  
Также содержит функции, упрощающие игру в фракциях SRP.  
  
Папка `brightbinder` содержит меню, которое составил и использую я.  
Его можно использовать как основу для собственных меню.

**DISCLAIMER:** Для работы со скриптом нужны прямые руки.  
Перед использованием настоятельно рекомендуется прочитать информацию ниже.  
Автор не несёт ответственности за непреднамеренный выход на государственную волну и прочие исходы тыканья случайных кнопок.

## Как это работает?
 - Требуются [MoonLoader](https://www.blast.hk/threads/13305/) и плагин [SAMP.Events](https://www.blast.hk/threads/14624/) (уже имеются в [этой сборке](https://samp-rp.su/threads/grand-theft-auto-san-andreas-bazovaja-sborka-igry-na-pk.2228702/)).  
Сам плагин (файлы `.lua`, `.cfg` и папка `brightbinder`) помещается в папку `moonloader`
 - Чтобы вызвать меню, нажмите `LAlt`, удерживая правую кнопку мыши.
   - Если при этом прицел наведён на игрока, его ID/ник можно будет использовать в подстановке.
   - Заголовок окна отображает информацию о выбранном игроке.
 - Файлы меню находятся в папке `brightbinder`.  
По умолчанию открывается меню из файла `default.txt`.
 - Структура файлов меню немного схожа со структурой файлов AHK:
   - Отображаемые пункты - строки, начинающиеся с `@`.
     - Отображается текст после `@`. Доступно цветовое форматирование.
   - После них идут действия - простой ввод в чат, либо особое действие, начинающееся с `$`:
     - `$wait X` - ждать X миллисекунд перед выполнением следующего действия.
     - `$showmenu X` - открыть меню из файла `X.txt` (здесь и далее расширение не указывается).
     - `$showtext X` - открыть текст из файла `X.txt` для чтения в отдельном окне.
     - `$showtextwait X` - то же самое, но следующее действие не выполняется, пока окно не закрыто.
   - Возможна автоматическая подстановка данных игроков:
     - `%id` будет заменено на ID игрока, на которого наведён прицел.
     - `%name` - то же самое для ника игрока.
     - `%myid` будет заменено на Ваш ID.
     - `%myname` - то же самое для Вашего ника.
     - Если в строке есть подстановка игрока под прицелом, но игрок не был выбран, строка отправлена не будет.
   - Возможно использование табуляций для более удобного чтения файлов.
 - Файлы меню подгружаются в реальном времени. Их можно редактировать, не перезагружая игру.
 - При сохранении файлов через Блокнот выбирайте опцию ANSI, иначе кириллица может отображаться в игре иероглифами.

## Дополнительные функции
 - Эти функции можно настроить через файл `brightbinder.cfg` в папке скрипта.  
Чтобы загрузить изменённые настройки во время игры, введите `/bbload`.
 - **Автоматическая смена клиста**  - `src_clist`/`dst_clist`  
Скрипт вызовет команду `/clist dst_clist`, если сервер установит вам цвет `src_clist`.  
Пока что значение `src_clist` - RGB код цвета, в будущем будет настроен ID цвета на SRP.
 - **Автоматическая подстановка тега в рацию** - `rtag`  
Скрипт автоматически подставит `rtag` перед сообщением при вводе `/r`.  
Если значение `rtag` пусто или не указано, подстановки не будет.
 - **Отключение меню выдачи лицензий по прицелу** - `disable_auto_givelicense`  
Скрипт заблокирует выведение меню `/givelicense` через наведение прицела.
 - Для разработчиков/составителей меню: **Смена режима вывода** - `sending_mode`  
Доступные значения: `process`, `send`, `debug`.  
Первые два значения позволяют выбрать опкод для отправки текста.  
Выбор `debug` (или любое другое значение) приведёт к выводу отправляемого текста в чат вместо отправки.
